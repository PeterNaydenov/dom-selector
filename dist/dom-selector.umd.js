!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).domSelector=n()}(this,(function(){"use strict";return function(){const e=new Map,n=new Map;function t(n){let{name:t,selector:i,where:o,direction:r,final:f}=n;return!!(t&&i&&i instanceof Function)&&(o||(o=({item:e})=>e),f||(f=e=>e),r||(r="none"),e.set(t,{name:t,selector:i,where:o,direction:r,final:f}),!0)}function*i(e,n=!1){if(yield e,n)return;const t=e.parentElement;"BODY"===t.tagName&&(n=!0),yield*i(t,n)}function*o(e){yield e;const n=e.children;if(0!==n.length)for(let e of n)yield*o(e)}function r(e){return e instanceof NodeList||e instanceof HTMLCollection?Array.from(e):e instanceof Array?e:null==e?[]:[e]}return{define:t,remember:function(e,t){t?.length?n.set(e,t):n.set(e,[t])},run:function(f,...l){if("string"!=typeof f){if(!t(f))return[]}let u=e.get(f);if(null==u)return[];let{name:c,selector:s,direction:d,where:a,final:m}=u,h=function(e,n,t,...f){const l="none"!==n,u=t instanceof Function,c=[],s=Symbol("end___");let d=r(e);if(0===d.length)return c;if(l&&(d=d.reduce(((e,t)=>(t instanceof HTMLElement&&("up"===n?e.push(...i(t)):"down"===n&&e.push(...o(t))),e)),[])),u){let e=0;for(let n of d){let l=t({item:n,i:e,END:s,length:c.length,down:o,up:i},...f);if(e++,l===s)break;l&&c.push(...r(l))}}return c}(s(...l),d,a,...l);return n.set(f,h),m(h,...l)},use:function(e){const t=n.get(e);return null==t?[]:t}}}}));
