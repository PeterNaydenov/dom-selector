"use strict";module.exports=function(){const e=new Map,n=new Map;function t(n){let{name:t,selector:i,where:r,direction:o,final:l}=n;return!!(t&&i&&i instanceof Function)&&(r||(r=({item:e})=>e),l||(l=e=>e),o||(o="none"),e.set(t,{name:t,selector:i,where:r,direction:o,final:l}),!0)}function*i(e,n=!1){if(yield e,n)return;const t=e.parentElement;"BODY"===t.tagName&&(n=!0),yield*i(t,n)}function*r(e){yield e;const n=e.children;if(0!==n.length)for(let e of n)yield*r(e)}function o(e){return e instanceof NodeList||e instanceof HTMLCollection?Array.from(e):e instanceof Array?e:null==e?[]:[e]}return{define:t,remember:function(e,t){t?.length?n.set(e,t):n.set(e,[t])},run:function(l,...u){if("string"!=typeof l){if(!t(l))return[]}let f=e.get(l);if(null==f)return[];let{name:c,selector:s,direction:a,where:d,final:m}=f,h=function(e,n,t,...l){const u="none"!==n,f=t instanceof Function,c=[],s=Symbol("end___");let a=o(e);if(0===a.length)return c;if(u&&(a=a.reduce(((e,t)=>(t instanceof HTMLElement&&("up"===n?e.push(...i(t)):"down"===n&&e.push(...r(t))),e)),[])),f){let e=0;for(let n of a){let u=t({item:n,i:e,END:s,length:c.length,down:r,up:i},...l);if(e++,u===s)break;u&&c.push(...o(u))}}return c}(s(...u),a,d,...u);return n.set(l,h),m(h,...u)},use:function(e){const t=n.get(e);return null==t?[]:t}}};
